// SPDX-License-Identifier: GPL-2.0
/*
 * Device Tree Source for the Spider CPU and Breakout boards
 *
 * Copyright (C) 2021 Renesas Electronics Corp.
 */

/dts-v1/;
#include "r8a779f0-spider-cpu.dtsi"
#include "r8a779f0-spider-ethernet.dtsi"

/ {
	model = "Renesas Spider CPU and Breakout boards based on r8a779f0";
	compatible = "renesas,spider-breakout", "renesas,spider-cpu", "renesas,r8a779f0";

	aliases {
		eth0 = &rswitch;
		};
};

&i2c4 {
	eeprom@51 {
		compatible = "rohm,br24g01", "atmel,24c01";
		label = "breakout-board";
		reg = <0x51>;
		pagesize = <8>;
	};
};

&canfd0 {
	pinctrl-0 = <&canfd0_pins>, <&canfd1_pins>, <&canfd2_pins>,
				<&canfd3_pins>, <&canfd4_pins>, <&canfd5_pins>,
				<&canfd6_pins>, <&canfd7_pins>;
	pinctrl-names = "default";
	status = "okay";

	channel0 {
		status = "okay";
	};

	channel1 {
		status = "okay";
	};

	channel2 {
		status = "okay";
	};

	channel3 {
		status = "okay";
	};

	channel4 {
		status = "okay";
	};

	channel5 {
		status = "okay";
	};

	channel6 {
		status = "okay";
	};

	channel7 {
		status = "okay";
	};
};

&canfd1 {
	pinctrl-0 = <&canfd8_pins>,<&canfd9_pins>, <&canfd10_pins>, 
				<&canfd11_pins>, <&canfd12_pins>, <&canfd13_pins>, 
				<&canfd14_pins>, <&canfd15_pins>;
	pinctrl-names = "default";
	status = "okay";

	channel0 {
		status = "okay";
	};

	channel1 {
		status = "okay";
	};

	channel2 {
		status = "okay";
	};

	channel3 {
		status = "okay";
	};

	channel4 {
		status = "okay";
	};

	channel5 {
		status = "okay";
	};

	channel6 {
		status = "okay";
	};

	channel7 {
		status = "okay";
	};
};

&pfc {
	tsn0_pins: tsn0 {
		mux {
			groups = "tsn0_link", "tsn0_mdio";
			function = "tsn0";
			drive-strength = <18>;
			power-source = <1800>;
		};

		pins_mdio {
			groups = "tsn0_mdio";
			drive-strength = <18>;
			power-source = <1800>;
		};
	};

	tsn1_pins: tsn1 {
		mux {
			groups = "tsn1_link", "tsn1_mdio";
			function = "tsn1";
			drive-strength = <18>;
			power-source = <1800>;
		};

		pins_mdio {
			groups = "tsn1_mdio";
			drive-strength = <18>;
			power-source = <1800>;
		};
	};

	tsn2_pins: tsn2 {
		mux {
			groups = "tsn2_link", "tsn2_mdio";
			function = "tsn2";
			drive-strength = <18>;
			power-source = <1800>;
		};

		pins_mdio {
			groups = "tsn2_mdio";
			drive-strength = <18>;
			power-source = <1800>;
		};
	};

	canfd0_pins: canfd0 {
		groups = "canfd0_data";
		function = "canfd0";
	};

	canfd1_pins: canfd1 {
		groups = "canfd1_data";
		function = "canfd1";
	};

	canfd2_pins: canfd2 {
		groups = "canfd2_data";
		function = "canfd2";
	};

	canfd3_pins: canfd3 {
		groups = "canfd3_data";
		function = "canfd3";
	};

	canfd4_pins: canfd4 {
		groups = "canfd4_data";
		function = "canfd4";
	};

	canfd5_pins: canfd5 {
		groups = "canfd5_data";
		function = "canfd5";
	};

	canfd6_pins: canfd6 {
		groups = "canfd6_data";
		function = "canfd6";
	};

	canfd7_pins: canfd7 {
		groups = "canfd7_data";
		function = "canfd7";
	};

	canfd8_pins: canfd8 {
		groups = "canfd8_data";
		function = "canfd8";
	};

	canfd9_pins: canfd9 {
		groups = "canfd9_data";
		function = "canfd9";
	};

	canfd10_pins: canfd10 {
		groups = "canfd10_data";
		function = "canfd10";
	};

	canfd11_pins: canfd11 {
		groups = "canfd11_data";
		function = "canfd11";
	};

	canfd12_pins: canfd12 {
		groups = "canfd12_data";
		function = "canfd12";
	};

	canfd13_pins: canfd13 {
		groups = "canfd13_data";
		function = "canfd13";
	};

	canfd14_pins: canfd14 {
		groups = "canfd14_data";
		function = "canfd14";
	};

	canfd15_pins: canfd15 {
		groups = "canfd15_data";
		function = "canfd15";
	};

	pcie0_pins: pcie0 {
		groups = "pcie0_clkreq_n";
		function = "pcie";
	};

	pcie1_pins: pcie1 {
		groups = "pcie1_clkreq_n";
		function = "pcie";
	};

	taud0_pwm_pins: taud0_pwm {
		groups = "taud0_pwm1", "taud0_pwm2";
		function = "taud0_pwm";
	};
};

&rswitch {
	status = "okay";
	pinctrl-0 = <&tsn0_pins &tsn1_pins &tsn2_pins>;
	pinctrl-names = "default";
	#address-cells = <1>;
	#size-cells = <0>;

	ports {
		#address-cells = <1>;
		#size-cells = <0>;
		port@0 {
			reg = <0>;
			phy-handle = <&etha0>;
			#address-cells = <1>;
			#size-cells = <0>;
			etha0: ethernet-phy@0 {
				reg = <1>;
				compatible = "ethernet-phy-ieee802.3-c45";
			};
		};
		port@1 {
			reg = <1>;
			phy-handle = <&etha1>;
			#address-cells = <1>;
			#size-cells = <0>;
			etha1: ethernet-phy@1 {
				reg = <2>;
				compatible = "ethernet-phy-ieee802.3-c45";
			};
		};
		port@2 {
			reg = <2>;
			phy-handle = <&etha2>;
			#address-cells = <1>;
			#size-cells = <0>;
			etha2: ethernet-phy@2 {
				reg = <3>;
				compatible = "ethernet-phy-ieee802.3-c45";
			};
		};
	};
};

&pcie_bus_clk {
	clock-frequency = <100000000>;
};

&pciec0 {
	status = "okay";
	pinctrl-0 = <&pcie0_pins>, <&pcie1_pins>;
	pinctrl-names = "default";
	clkreq-gpios = <&gpio2 15 GPIO_ACTIVE_LOW>;
};

&pciec0_ep {
	status = "disabled";
	pinctrl-0 = <&pcie0_pins>;
	pinctrl-names = "default";
	clkreq-gpios = <&gpio2 15 GPIO_ACTIVE_LOW>;
};

&pciec1 {
	status = "disabled";
	pinctrl-0 = <&pcie1_pins>;
	pinctrl-names = "default";
	clkreq-gpios = <&gpio2 16 GPIO_ACTIVE_LOW>;
};

&pciec1_ep {
	status = "disabled";
	pinctrl-0 = <&pcie1_pins>;
	pinctrl-names = "default";
	clkreq-gpios = <&gpio2 16 GPIO_ACTIVE_LOW>;
};

&tau_pwm0 {
	pinctrl-0 = <&taud0_pwm_pins>;
	pinctrl-names = "default";

	status = "disable";
};
